{"ast":null,"code":"// connect token from login to user credentials\nconst jsonwebtoken = require(\"jsonwebtoken\"); // import jsonwebtoken\n\n\nconst config = require(\"config\"); // import config\n\n\nconst {\n  response\n} = require(\"express\"); // auto imported express (response)\n\n\nmodule.exports = (request, response, next) => {\n  // get token from header\n  const token = request.header(\"x-auth-token\"); // check if token exists\n\n  if (!token) {\n    return response.status(401).json({\n      message: \"No token, authorisation denied\"\n    });\n  } // verify token\n\n\n  try {\n    const decoded = jsonwebtoken.verify(token, config.get(\"jsonWebTokenSecret\"));\n    request.user = decoded.user;\n    next();\n  } catch (err) {\n    response.status(401).json({\n      message: \"Token is not valid\"\n    });\n  }\n};","map":{"version":3,"sources":["/home/saad/Desktop/udemy/contact-keeper/middleware/auth.js"],"names":["jsonwebtoken","require","config","response","module","exports","request","next","token","header","status","json","message","decoded","verify","get","user","err"],"mappings":"AAAA;AACA,MAAMA,YAAY,GAAGC,OAAO,CAAC,cAAD,CAA5B,C,CAA8C;;;AAC9C,MAAMC,MAAM,GAAGD,OAAO,CAAC,QAAD,CAAtB,C,CAAkC;;;AAClC,MAAM;AAAEE,EAAAA;AAAF,IAAeF,OAAO,CAAC,SAAD,CAA5B,C,CAAyC;;;AAEzCG,MAAM,CAACC,OAAP,GAAiB,CAACC,OAAD,EAAUH,QAAV,EAAoBI,IAApB,KAA6B;AAC5C;AACA,QAAMC,KAAK,GAAGF,OAAO,CAACG,MAAR,CAAe,cAAf,CAAd,CAF4C,CAG5C;;AACA,MAAI,CAACD,KAAL,EAAY;AACV,WAAOL,QAAQ,CACZO,MADI,CACG,GADH,EAEJC,IAFI,CAEC;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAFD,CAAP;AAGD,GAR2C,CAS5C;;;AACA,MAAI;AACF,UAAMC,OAAO,GAAGb,YAAY,CAACc,MAAb,CACdN,KADc,EAEdN,MAAM,CAACa,GAAP,CAAW,oBAAX,CAFc,CAAhB;AAIAT,IAAAA,OAAO,CAACU,IAAR,GAAeH,OAAO,CAACG,IAAvB;AACAT,IAAAA,IAAI;AACL,GAPD,CAOE,OAAOU,GAAP,EAAY;AACZd,IAAAA,QAAQ,CAACO,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAA1B;AACD;AACF,CApBD","sourcesContent":["// connect token from login to user credentials\nconst jsonwebtoken = require(\"jsonwebtoken\"); // import jsonwebtoken\nconst config = require(\"config\"); // import config\nconst { response } = require(\"express\"); // auto imported express (response)\n\nmodule.exports = (request, response, next) => {\n  // get token from header\n  const token = request.header(\"x-auth-token\");\n  // check if token exists\n  if (!token) {\n    return response\n      .status(401)\n      .json({ message: \"No token, authorisation denied\" });\n  }\n  // verify token\n  try {\n    const decoded = jsonwebtoken.verify(\n      token,\n      config.get(\"jsonWebTokenSecret\")\n    );\n    request.user = decoded.user;\n    next();\n  } catch (err) {\n    response.status(401).json({ message: \"Token is not valid\" });\n  }\n};\n"]},"metadata":{},"sourceType":"script"}